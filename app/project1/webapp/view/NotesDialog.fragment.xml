<core:FragmentDefinition
    xmlns="sap.m"
    xmlns:core="sap.ui.core"
    xmlns:f="sap.ui.layout.form">
    <Dialog id="notesDialog" title="My Notes Workspace" contentWidth="900px" contentHeight="700px" resizable="true">
        <content>
            <HBox id="notesMainContainer" class="sapUiNoMargin">
                <!-- Notes Sidebar -->
                <VBox id="notesSidebar" width="250px" class="sapUiMediumMarginEnd">
                    <Panel id="notesListPanel" headerText="My Notes">
                        <headerToolbar>
                            <Toolbar id="notesToolbar">
                                <Title id="notesListTitle" text="Notes"/>
                                <ToolbarSpacer id="notesToolbarSpacer"/>
                                <Button id="addNoteBtn" icon="sap-icon://add" type="Transparent" press="onAddNote" tooltip="Add New Note"/>
                            </Toolbar>
                        </headerToolbar>
                        <content>
                            <List id="notesList" items="{/notes}" mode="SingleSelect" selectionChange="onNoteSelect">
                                <CustomListItem id="noteListItem" type="Active">
                                    <content>
                                        <VBox id="noteItemBox" class="sapUiMediumMargin">
                                            <Title id="noteItemTitle" text="{title}" level="H6" class="sapUiTinyMarginBottom"/>
                                            <Text id="noteItemPreview" text="{preview}" maxLines="2" class="sapUiContentLabelColor sapUiTinyMarginBottom"/>
                                            <HBox id="noteItemMeta" justifyContent="SpaceBetween" class="sapUiTinyMarginTop">
                                                <VBox id="noteItemStats">
                                                    <Text id="noteItemCategory" text="{category}" class="sapUiContentLabelColor"/>
                                                    <Text id="noteItemWordCount" text="{wordCount} words" class="sapUiContentLabelColor"/>
                                                </VBox>
                                                <Text id="noteItemModified" text="{lastModified}" class="sapUiContentLabelColor"/>
                                            </HBox>
                                        </VBox>
                                    </content>
                                    <customData>
                                        <core:CustomData id="noteData" key="noteId" value="{id}"/>
                                    </customData>
                                </CustomListItem>
                            </List>
                        </content>
                    </Panel>

                    <!-- Tags Panel -->
                    <Panel id="tagsPanel" headerText="Tags & Categories" class="sapUiTinyMarginTop">
                        <content>
                            <VBox id="tagsContainer" class="sapUiTinyMargin">
                                <ComboBox id="categoryFilter" placeholder="Filter by category" items="{/categories}" selectionChange="onCategoryFilter" class="sapUiTinyMarginBottom">
                                    <core:Item id="categoryItem" key="{}" text="{}"/>
                                </ComboBox>
                                <Input id="newTagInput" placeholder="Add new tag..." submit="onAddTag" class="sapUiTinyMarginBottom"/>
                                <ScrollContainer id="tagsScrollContainer" height="150px">
                                    <VBox id="tagsBox" class="sapUiTinyMarginTop">
                                        <Text id="tagsLabel" text="Available Tags:" class="sapUiTinyMarginBottom"/>
                                        <HBox id="tagsButtonsBox" wrap="Wrap">
                                            <!-- Tags will be populated dynamically -->
                                        </HBox>
                                    </VBox>
                                </ScrollContainer>
                            </VBox>
                        </content>
                    </Panel>
                </VBox>

                <!-- Note Editor -->
                <VBox id="noteEditor" class="sapUiNoMargin">
                    <Panel id="editorPanel" headerText="Note Editor">
                        <headerToolbar>
                            <Toolbar id="editorToolbar">
                                <Input id="noteTitleInput" value="{/currentNote/title}" placeholder="Note title..." width="300px"/>
                                <ToolbarSpacer id="editorToolbarSpacer"/>
                                <Button id="saveNoteBtn" text="Save" type="Emphasized" press="onSaveNote" icon="sap-icon://save"/>
                                <Button id="deleteNoteBtn" text="Delete" type="Transparent" press="onDeleteNote" icon="sap-icon://delete"/>
                            </Toolbar>
                        </headerToolbar>
                        <content>
                            <VBox id="editorContent" class="sapUiMediumMargin">
                                <!-- Formatting Toolbar -->
                                <Toolbar id="formatToolbar" class="sapUiTinyMarginBottom">
                                    <Button id="boldBtn" icon="sap-icon://bold-text" type="Transparent" press="onFormatText" tooltip="Bold"/>
                                    <Button id="italicBtn" icon="sap-icon://italic-text" type="Transparent" press="onFormatText" tooltip="Italic"/>
                                    <Button id="underlineBtn" icon="sap-icon://underline-text" type="Transparent" press="onFormatText" tooltip="Underline"/>
                                    <ToolbarSeparator id="formatSeparator1"/>
                                    <Button id="bulletListBtn" icon="sap-icon://bullet-text" type="Transparent" press="onFormatText" tooltip="Bullet List"/>
                                    <Button id="numberedListBtn" icon="sap-icon://numbered-text" type="Transparent" press="onFormatText" tooltip="Numbered List"/>
                                    <ToolbarSeparator id="formatSeparator2"/>
                                    <Button id="linkBtn" icon="sap-icon://chain-link" type="Transparent" press="onAddLink" tooltip="Add Link"/>
                                    <Button id="imageBtn" icon="sap-icon://picture" type="Transparent" press="onAddImage" tooltip="Add Image"/>
                                </Toolbar>

                                <!-- Text Editor -->
                                <TextArea id="noteContentEditor" 
                                    value="{/currentNote/content}" 
                                    rows="20" 
                                    width="100%" 
                                    placeholder="Start writing your note here...&#10;&#10;Tips:&#10;• Use markdown-like syntax&#10;• # for headers&#10;• - for bullet points&#10;• ** for bold text&#10;• * for italic text"/>

                                <!-- Note Metadata -->
                                <HBox id="noteMetadata" class="sapUiTinyMarginTop" justifyContent="SpaceBetween">
                                    <VBox id="noteInfo">
                                        <Text id="createdDate" text="Created: {/currentNote/created}" class="sapUiContentLabelColor"/>
                                        <Text id="modifiedDate" text="Last Modified: {/currentNote/lastModified}" class="sapUiContentLabelColor"/>
                                    </VBox>
                                    <VBox id="noteStats">
                                        <Text id="wordCount" text="Words: {/currentNote/wordCount}" class="sapUiContentLabelColor"/>
                                        <Text id="charCount" text="Characters: {/currentNote/charCount}" class="sapUiContentLabelColor"/>
                                    </VBox>
                                </HBox>
                            </VBox>
                        </content>
                    </Panel>
                </VBox>
            </HBox>
        </content>
        <endButton>
            <Button id="closeNotesBtn" text="Close" press="onCloseNotesDialog"/>
        </endButton>
    </Dialog>
</core:FragmentDefinition>
